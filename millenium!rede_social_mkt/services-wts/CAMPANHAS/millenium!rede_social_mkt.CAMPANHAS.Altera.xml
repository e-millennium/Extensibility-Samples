<?xml version="1.0"?>
<root>
  <OBJECT NAME="CAMPANHAS">
    <METHOD NAME="Altera" DESCRIPTION="Altera Campanha" VERSION="30" INTFTYPE="2" THREADSAFE="0">
      <PARAMS>
        <GROUPS>
          <GROUP/>
          <GROUP NAME="Per&#237;odo Valdiade"/>
        </GROUPS>
        <PARAM NAME="CAMPANHA" FORMAT="+" SIZE="8" FLAGS="1024" PROJECTION="0" FIELDLABEL="Codigo" CTAB="0"/>
        <PARAM NAME="NUMERO_CUPOM" SIZE="50" FLAGS="17" PROJECTION="0" ORDER="1" FIELDLABEL="N&#250;mero Cupom" CTAB="0"/>
        <PARAM NAME="DESCRICAO" SIZE="100" FLAGS="17" PROJECTION="0" ORDER="2" FIELDLABEL="Descri&#231;&#227;o" CTAB="0"/>
        <PARAM NAME="REDE_SOCIAL" FORMAT="N" SIZE="8" FLAGS="17" PROJECTION="0" ORDER="3" LOOKUP="REDES_SOCIAIS.LISTA" LOOKUPKEY="REDE_SOCIAL" LOOKUPDISPLAY="DESCRICAO" FIELDLABEL="Rede Social" CTAB="0"/>
        <PARAM NAME="DATA_INICIAL" FORMAT="D" SIZE="10" FLAGS="17" PROJECTION="0" ORDER="7" FIELDLABEL="Data Inical" GROUPNAME="Per&#237;odo Valdiade" CTAB="0"/>
        <PARAM NAME="DATA_FINAL" FORMAT="D" SIZE="10" FLAGS="17" PROJECTION="0" ORDER="8" FIELDLABEL="Data Final" GROUPNAME="Per&#237;odo Valdiade" CTAB="0"/>
        <PARAM NAME="PERCENTUAL_DESCONTO" FORMAT="N" SIZE="8" FLAGS="17" PROJECTION="0" ORDER="5" FIELDLABEL="Percentual Desconto" CTAB="0"/>
        <PARAM NAME="VALOR_MAXIMO_COMPRA" FORMAT="M" SIZE="17" FLAGS="17" DECIMALS="4" PROJECTION="0" HINT="Para campanhas que n&#227;o tenham restri&#231;&#245;es de valor m&#225;ximo de compra. Informe valor &#34;0&#34;." ORDER="4" FIELDLABEL="Valor M&#225;ximo da Compra" CTAB="0"/>
      </PARAMS>
      <FIELDS/>
      <ACTIONSCRIPT>#CHECK("SELECT COUNT(*) AS N FROM RSM_CAMPANHAS WHERE NUMERO_CUPOM&lt;>:NUMERO_CUPOM AND CAMPANHA=:CAMPANHA",N>0,"Cupom j&#225; utilizado. N&#227;o &#233; permitido altera&#231;&#227;o.");

DELETE FROM RSM_CAMPANHAS
WHERE CAMPANHA=:CAMPANHA;

INSERT INTO RSM_CAMPANHAS (CAMPANHA,DESCRICAO,REDE_SOCIAL,NUMERO_CUPOM,DATA_INICIAL,DATA_FINAL,PERCENTUAL_DESCONTO,VALOR_MAXIMO_COMPRA)
       VALUES (:CAMPANHA,:DESCRICAO,:REDE_SOCIAL,:NUMERO_CUPOM,:DATA_INICIAL,:DATA_FINAL,:PERCENTUAL_DESCONTO,:VALOR_MAXIMO_COMPRA);
</ACTIONSCRIPT>
    </METHOD>
  </OBJECT>
</root>